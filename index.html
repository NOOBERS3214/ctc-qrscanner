<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Continuous QR Scanner with Excel Export</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial; background:#0b0b0b; color:#fff; text-align:center; }
video { width:100%; max-width:420px; border:2px solid #0f0; margin-bottom:10px; }
table { width:100%; max-width:420px; margin:auto; border-collapse:collapse; margin-top:10px; }
th, td { border:1px solid #333; padding:6px; font-size:14px; }
th { background:#111; }
select, button { padding:6px; margin:5px; font-size:16px; }
button { cursor:pointer; }
</style>
</head>

<body>

<h2>CTC Register Taker</h2>

<label>Select Year:</label><br>
<select id="yearSelect">
  <option value="Year 1">Year 1</option>
  <option value="Year 2">Year 2</option>
  <option value="Year 3">Year 3</option>
  <option value="Year 4">Year 4</option>
</select>

<br>
<button onclick="startScanner()">Start Scanner</button>
<button onclick="exportExcel()">Export to Excel</button>

<video id="video" autoplay></video>
<canvas id="canvas" hidden></canvas>

<p id="status">Waiting to startâ€¦</p>

<table>
<thead>
<tr>
  <th>#</th>
  <th>QR Data</th>
  <th>Year</th>
  <th>Time</th>
</tr>
</thead>
<tbody id="log"></tbody>
</table>

<!-- QR Scanner -->
<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
<!-- Excel Export -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
const video = document.getE

